(()=>{function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}var t=["Team Lead","Programmer","QA"];$(document).ready((function(){var o=$("#proj_members_tbl").DataTable({pageLength:10,ordering:!1,oLanguage:{sEmptyTable:"No Data",sZerorRecords:"No Data",sInfoFiltered:""},columnDefs:[{targets:[5],visible:!1}],sDom:"lrt<'#bottom.row'<'#info.col'i><'#pagination.col'p>>"});function a(){o.column(5).search($("#show_hist").is(":checked")?"":"1").draw()}a(),$("#show_hist").on("change",(function(){a()})),$("#link_request_tbl").DataTable({pageLength:10,ordering:!1,oLanguage:{sEmptyTable:"No Data"},sDom:"lrt<'#bottom.row'<'#info.col'i><'#pagination.col'p>>"});var n=$("#linked_softwares_tbl").DataTable({pageLength:10,ordering:!1,oLanguage:{sEmptyTable:"No Data"},sDom:"lrt<'#bottom.row'<'#info.col'i><'#pagination.col'p>>"});function r(e){var a,n,r;o.clear().draw(),e.update.forEach((function(e){a=window.location.origin+"/employees/"+e.employee_id,r={id:e.id,member:e.member_name_update,start_date:l(e.start_date),end_date:l(e.end_date),onsite_flag:e.onsite_flag,project_role_type:e.project_role_type,remarks:e.remarks},n=['<a href="'+a+'" class="text-decoration-none">'+e.member_name+"</a>",t[Number(e.project_role_type)-1],e.onsite_flag?"Yes":"No",e.membership_date],e.isActive?n.push('<button class="btn btn-link btn-sm text-success employee_linkage_update_btn" data-bs-target="#update_employee_linkage_modal" data-bs-toggle="modal" data-modaldata=\''+JSON.stringify(r)+"'>Update</button>"):n.push(""),n.push(e.isActive),o.row.add(n).draw(!1)}))}function l(t){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"-";if(null==e(t)||""==t)return"";t=new Date(t),console.log("object    "+t);var a=t.getMonth()+1;1==a.toString().length&&(a="0"+a);var n=t.getDate();return 1==n.toString().length&&(n="0"+n),t.getFullYear()+o+a+o+n}$("#pj_submit_btn").click((function(e){$("#link_update_spinner").show();var t={_token:$("#link_employee_form > input[name=_token]").val(),employee_id:$("#member_list > option:selected").val(),project_id:$("#link_employee_form > input[name=project_id]").val(),project_start:$("#link_project_start").val(),project_end:$("#link_project_end").val(),project_role:$("#link_role > option:selected").val(),project_onsite:$("#link_onsite").is(":checked")?1:0,remarks:$("#link_remarks").val(),is_employee:!0};$.ajax({type:"POST",url:"/api/linkEmployeeToProject",data:t,dataType:"json",encode:!0}).done((function(e){if($("#link_update_spinner").hide(),e.success)$("#link_employee_form").trigger("reset"),$("#link_employee_form").find("[name]").each((function(){console.log($(this).val()),$("#link_employee_form > #link_"+$(this).attr("name")+"_error").length>0&&$("#link_employee_form > #link_"+$(this).attr("name")+"_error").empty()})),$("#member_list > option[value="+t.employee_id+"]").remove(),$("#le_success_msg").html('<i class="bi bi-check-circle-fill"></i>&nbsp;'+e.message+".").addClass("text-success mb-2 text-start"),r(e);else for(key in $("#le_success_msg").empty(),$("#link_employee_form").find("[name]").each((function(){$("#link_employee_form  #link_"+$(this).attr("name")+"_error").length>0&&$("#link_employee_form  #link_"+$(this).attr("name")+"_error").empty()})),e.data)console.log(e.data[key][0]),$("#link_employee_form #link_"+key+"_error").html(e.data[key][0]).addClass("text-danger text-start")})).fail((function(){console.log("error")})),e.preventDefault()})),$("#link_employee_modal").on("hidden.bs.modal",(function(){$("#le_success_msg").empty(),$("#link_employee_form").find("[name]").each((function(){$("#link_employee_form > #link_"+$(this).attr("name")+"_error").length>0&&$("#link_employee_form > #link_"+$(this).attr("name")+"_error").empty()}))})),$("#update_pj_submit_btn").click((function(e){$("#link_update_spinner").show();var t={_token:$("#update_employee_linkage_form > input[name=_token]").val(),linkage_id:$("#update_employee_linkage_form input[name=linkage_id]").val(),project_start:$("#update_employee_linkage_form input[name=project_start]").val(),project_end:$("#update_employee_linkage_form input[name=project_end]").val(),project_role:$("#update_link_role > option:selected").val(),project_onsite:$("#update_employee_linkage_form  input[name=onsite]").is(":checked")?1:0,remarks:$("#update_link_remarks").val(),is_employee_update:!0};$.ajax({type:"POST",url:"/api/updateEmployeeProjectLinkage",data:t,dataType:"json",encode:!0}).done((function(e){if($("#link_update_spinner").hide(),e.success)$("#update_employee_linkage_form").trigger("reset"),$("#update_employee_linkage_form").find("[name]").each((function(){console.log($(this).val()),$("#link_employee_form > #link_"+$(this).attr("name")+"_error").length>0&&$("#link_employee_form > #link_"+$(this).attr("name")+"_error").empty()})),$("#ue_success_msg").html('<i class="bi bi-check-circle-fill"></i>&nbsp;'+e.message+".").addClass("text-success mb-2 text-start"),r(e);else for(key in $("#ue_success_msg").empty(),$("#update_employee_linkage_form").find("[name]").each((function(){$("#update_employee_linkage_form > #link_"+$(this).attr("name")+"_error").length>0&&$("#update_employee_linkage_form > #link_"+$(this).attr("name")+"_error").empty()})),e.data)console.log(e.data[key][0]),$("#update_employee_linkage_form #link_"+key+"_error").html(e.data[key][0]).addClass("text-danger text-start")})).fail((function(){console.log("error")})),e.preventDefault()})),$("#update_employee_linkage_modal").on("hidden.bs.modal",(function(){$("#ue_success_msg").empty(),$("#update_employee_linkage_form").find("[name]").each((function(){$("#update_employee_linkage_form > #link_"+$(this).attr("name")+"_error").length>0&&$("#update_employee_linkage_form > #link_"+$(this).attr("name")+"_error").empty()}))})),$("#ls_submit_btn").click((function(e){$("#link_software_spinner").show();var t={_token:$("#link_software_form > input[name=_token]").val(),software_id:$("#software_list > option:selected").val(),project_id:$("#link_software_form > input[name=project_id]").val(),remarks:$("#link_software_remarks").val()};$.ajax({type:"POST",url:"/api/linkSoftwareToProject",data:t,dataType:"json",encode:!0}).done((function(e){var o,a;if($("#link_software_spinner").hide(),e.success)$("#link_software_form").trigger("reset"),$("#link_software_form").find("[name]").each((function(){$("#link_software_form > #link_"+$(this).attr("name")+"_error").length>0&&$("#link_software_form > #link_"+$(this).attr("name")+"_error").empty()})),$("#software_list > option[value="+t.software_id+"]").remove(),$("#ls_success_msg").html('<i class="bi bi-check-circle-fill"></i>&nbsp;'+e.message+".").addClass("text-success mb-2 text-start"),n.clear().draw(),e.update.forEach((function(t){o=window.location.origin+"/softwares/"+t.software_id,a=['<a href="'+o+'" class="text-decoration-none">'+t.software_name+"</a>",t.software_type,t.linkageRemarks],e.isManager&&a.push('<button class="btn btn-link btn-sm text-danger software_linkage_remove_btn" form="remove_software_form" data-linkid="'+t.id+'" data-softwarename="'+t.software_name+'">Remove</button>'),n.row.add(a).draw(!1)})),$("#linked_softwares_tbl > tbody > tr").each((function(){$(this).find(":last-child").addClass("text-center")}));else for(key in $("#ls_success_msg").empty(),$("#link_software_form").find("[name]").each((function(){$("#link_software_form > #link_"+$(this).attr("name")+"_error").length>0&&$("#link_software_form > #link_"+$(this).attr("name")+"_error").empty()})),e.data)console.log(e.data[key][0]),$("#link_"+key+"_error").html(e.data[key][0]).addClass("text-danger text-start")})).fail((function(){console.log("error")})),e.preventDefault()})),$("#link_software_modal").on("hidden.bs.modal",(function(){$("#ls_success_msg").empty(),$("#link_software_form").find("[name]").each((function(){$("#link_software_form > #link_"+$(this).attr("name")+"_error").length>0&&$("#link_software_form > #link_"+$(this).attr("name")+"_error").empty()}))})),$("#linked_softwares_tbl").on("click",".software_linkage_remove_btn",(function(e){var t=$(this).data("linkid"),o=$(this).data("softwarename");if(console.log(t),!confirm("Are sure you want to remove "+o+"?"))return!1;console.log("ok"),$("#remove_software_form > input[name=id").val(t)})),$("#proj_members_tbl").on("click",".employee_linkage_update_btn",(function(){var e=$(this).data("modaldata");console.log(e),$("#member_info").text("Member: "+e.member),$("#update_employee_linkage_form input[name=linkage_id]").val(e.id),$("#update_employee_linkage_form input[name=project_start]").val(e.start_date),$("#update_employee_linkage_form input[name=project_end]").val(e.end_date),$("#update_employee_linkage_form select").val(e.project_role_type),e.onsite_flag&&$("#update_employee_linkage_form  input[name=onsite]").prop("checked",!0),$("#update_employee_linkage_form textarea").text(e.remarks)}))}))})();